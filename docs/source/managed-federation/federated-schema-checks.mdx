---
title: Federated schema checks
---

> For an introduction to schema checks, see [Schema checks](/graphos/schema-checks/).

Whenever you make changes to one of your supergraph's subgraph schemas, running [`rover subgraph check`](/rover/commands/subgraphs/#checking-subgraph-schema-changes) helps ensure that _all_ of your subgraph schemas still compose to a valid supergraph schema. This helps teams work independently on their portion of your supergraph without negatively affecting your users or other teams.

When you run `rover subgraph check` on a particular subgraph, GraphOS takes your schema changes and attempts to compose a supergraph schema from your published subgraph schemas.

* **If composition succeeds**, the result is compared against your _current_ supergraph schema to confirm that no known clients are affected by the proposed changes.
* **If composition fails**, check exection ends and error information is returned.

> Running `rover subgraph check` never updates your current supergraph schema.

## Check failures

Federated schema checks include both **composition checks** and **operation checks**. If either type of check fails, the entire checks execution fails.

- Composition checks fail if the proposed schema changes cause the composition process to fail.
  - For example, the changes might include a new field that's already defined in a different subgraph with a different return type.
- Operation checks fail due to breaking changes that would affect your supergraph's active clients, such as removing an actively queried field.

In almost all cases, you should run `rover subgraph publish` _only after_ a successful run of `rover subgraph check`.

**Even after `rover subgraph check` succeeds,** it's possible that `rover subgraph publish` produces composition errors because of simultaneous changes to _another_ subgraph.

An example output of this behavior looks like this:

```
$ rover subgraph publish docs-example-graph@current --name books --schema ./schema.graphql

Publishing SDL to docs-example-graph:current (subgraph: books) using credentials from the default profile.
The gateway for the 'docs-example-graph' graph was NOT updated with a new schema
WARN: The following composition errors occurred:
Field "Author.name" can only be defined once.
There can be only one type named "Author".
Field "Book.title" can only be defined once.
Field "Book.author" can only be defined once.
There can be only one type named "Book".
```

When this occurs, your subgraph's published schema is still updated. However, **the supergraph schema is not updated**. This means that your router's configuration is _also_ not updated.

The Apollo schema registry should always reflect what's running in your infrastructure, _even if what's running in your infrastructure produces a composition error._ However, you still want your router to function as it did with the most recent _valid_ combination of subgraph schemas.
