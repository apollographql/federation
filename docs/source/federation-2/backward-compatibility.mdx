---
title: Backward compatibility in Federation 2
sidebar_title: ⬅️ Backward compatibility
description: FAQ
---

## Do I need to modify my subgraph schemas to use Federation 2?

**Eventually.** The process of [moving to Federation 2](./moving-to-federation-2/) has two phases:

1. Use Federation 2 composition with your Federation 1 subgraph schemas.
2. Convert your Federation 1 subgraph schemas to true Federation 2 subgraph schemas.

Phase 1 usually requires _no_ changes to your subgraph schemas. Schemas that _do_ require changes are schemas that _should_ cause certain composition errors that Federation 1 fails to detect ([see below.](#breaking-changes)).

Phase 2 _does_ require some changes to your subgraph schemas, described [here](./moving-to-federation-2/#phase-2-modify-subgraph-schemas).


### Breaking changes

As mentioned above, the following Federation 1 examples _should_ produce composition errors, but they aren't detected. If your subgraph schemas include syntax that matches any of these, you need to update those schemas before moving to Federation 2.

<ExpansionPanel title="See breaking changes">

#### Invalid `@key` directives

An entity's `@key` consists of one or more of the entity's own `fields`. If any of these fields have _subfields_, the `@key` must _also_ include at least one of those subfields:

<p style="margin-bottom: 0">✅</p>

```graphql {1}
type User @key(fields: "id organization { id }") {
 id: ID!
 organization: Organization!
}

type Organization {
 id: ID!
 name: String!
}
```

In this example, the `User`'s key fields are `User.id` and `User.organization.id`.

Federation 1 composition _incorrectly_ allows a `@key` such as the following:

<p style="margin-bottom: 0">❌</p>

```graphql{1}
type User @key(fields: "id organization") {
 id: ID!
 organization: Organization!
}

type Organization {
 id: ID!
 name: String!
}
```

This `@key` should _break_ composition because it doesn't include at least one subfield of `Organization`.

#### Invalid `@requires` directives

A subgraph can mark an entity field with the [`@requires` directive](https://www.apollographql.com/docs/federation/entities/#extending-an-entity-with-computed-fields-advanced) to indicate that it depends on fields and subfields from _another_ subgraph:

<p style="margin-bottom: 0">✅</p>

```graphql
# Subgraph A
type Product @key(fields:"sku") {
  sku: ID!
  dimensions: ProductDimensions!
}

type ProductDimensions {
  size: Int!
  weight: Int!
}
```

```graphql {5}
# Subgraph B
extend type Product @key(fields:"sku") {
  sku: ID! @external
  dimensions: ProductDimensions! @external
  shippingEstimate: Int! @requires(fields: "dimensions { size weight }")
}

type ProductDimensions {
  size: Int!
  weight: Int!
}
```

In this example, Subgraph B's `shippingEstimate` field depends on the `dimensions.size` and `dimensions.weight` fields of Subgraph A.

Federation 1 _incorrectly_ allows a `@requires` directive such as the following:

<p style="margin-bottom: 0">❌</p>

```graphql
# Subgraph A
type Product @key(fields:"sku") {
  sku: ID!
  dimensions: ProductDimensions!
}

type ProductDimensions {
  size: Int!
  weight: Int!
}
```

```graphql {5}
# Subgraph B
extend type Product @key(fields:"sku") {
  sku: ID! @external
  dimensions: ProductDimensions! @external
  shippingEstimate: Int! @requires(fields: "dimensions { length depth }")
}

type ProductDimensions {
  size: Int!
  weight: Int!
}
```

This `@requires` directive should _break_ composition because it depends on subfields of `ProductDimensions` that _don't exist_ (`length` and `depth`).

</ExpansionPanel>


## Can Federation 1 compose my Federation 2 subgraph schemas?

**No,** not after you [convert at least one subgraph schema](#do-i-need-to-modify-my-subgraph-schemas-to-use-federation-2) to a true Federation 2 schema.

Federation 2 provides [more flexible composition rules](./new-in-federation-2/#more-flexible-composition) compared to Federation 1. After you modify your subgraph schemas to take advantage of this flexibility, your graph will no longer compose with Federation 1. You need to revert these changes to move _back_ to Federation 1.

## Does `@apollo/gateway` v2 support Federation 1?

**Yes.** If you want, you can update your gateway's `@apollo/gateway` library to its latest `2.x` version _before_ you're ready to [move your graph to Federation 2](./moving-to-federation-2/).

**Your plugins and customizations for `@apollo/gateway` `0.x` will continue to work as expected in `@apollo/gateway` `2.x`**.

## Is official support for `@apollo/gateway` v0.x being removed?

**No,** at _least_ through the end of 2022. We'll announce more specific updates about `@apollo/gateway` v0.x support as they're available.

## Compatibility table

| | Federation 1<br/>Composition | Federation 2<br/>Composition |
|-|--------------|--------------|
| `@apollo/gateway` v0.x | ✔️ | ❌ |
| `@apollo/gateway` v2.x | ✔️ | ✔️ |
| [Apollo Router](https://www.apollographql.com/docs/router/) | ✔️ | ✔️ |
